@model BikeStores_MVC.Models.MaintainVM
@{
    ViewBag.Title = "Maintain";
}

<h2 class="mt-3">Maintain Records</h2>

<div class="row">
    <!-- ===== STAFF SECTION ===== -->
    <div class="col-lg-4">
        <h4>Staff</h4>
        <table class="table table-sm table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var s in Model.Staff)
                {
                    <tr>
                        <td>@(s.first_name + " " + s.last_name)</td>
                        <td>@s.email</td>
                        <td>@s.phone</td>
                        <td>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#editStaffModal-@s.staff_id">
                                Edit
                            </button>
                            <button class="btn btn-sm btn-danger" data-bs-toggle="modal"
                                    data-bs-target="#deleteStaffModal-@s.staff_id">
                                Delete
                            </button>
                        </td>
                    </tr>

                    <!-- Edit Modal -->
                    <div class="modal fade" id="editStaffModal-@s.staff_id" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                @using (Html.BeginForm("Edit", "Staffs", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    @Html.Hidden("staff_id", s.staff_id)
                                    <div class="modal-header">
                                        <h5>Edit Staff</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="mb-2">@Html.Label("First name") @Html.TextBox("first_name", s.first_name, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("Last name") @Html.TextBox("last_name", s.last_name, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("Email") @Html.TextBox("email", s.email, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("Phone") @Html.TextBox("phone", s.phone, new { @class = "form-control" })</div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-primary">Save</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>

                    <!-- Delete Modal -->
                    <div class="modal fade" id="deleteStaffModal-@s.staff_id" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                @using (Html.BeginForm("Delete", "Staffs", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    @Html.Hidden("id", s.staff_id)
                                    <div class="modal-header bg-danger text-white">
                                        <h5>Confirm Delete</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        Are you sure you want to delete <strong>@s.first_name @s.last_name</strong>?
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-danger">Yes, Delete</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                }
            </tbody>
        </table>
    </div>

    <!-- ===== CUSTOMERS SECTION ===== -->
    <div class="col-lg-4">
        <h4>Customers</h4>
        <table class="table table-sm table-striped">
            <thead><tr><th>Name</th><th>Email</th><th>Actions</th></tr></thead>
            <tbody>
                @foreach (var c in Model.Customers)
                {
                    <tr>
                        <td>@(c.first_name + " " + c.last_name)</td>
                        <td>@c.email</td>
                        <td>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#editCustomerModal-@c.customer_id">
                                Edit
                            </button>
                            <button class="btn btn-sm btn-danger" data-bs-toggle="modal"
                                    data-bs-target="#deleteCustomerModal-@c.customer_id">
                                Delete
                            </button>
                        </td>
                    </tr>

                    <!-- Edit Customer Modal -->
                    <div class="modal fade" id="editCustomerModal-@c.customer_id" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                @using (Html.BeginForm("Edit", "Customers", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    @Html.Hidden("customer_id", c.customer_id)
                                    <div class="modal-header">
                                        <h5>Edit Customer</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="mb-2">@Html.Label("First name") @Html.TextBox("first_name", c.first_name, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("Last name") @Html.TextBox("last_name", c.last_name, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("Email") @Html.TextBox("email", c.email, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("Phone") @Html.TextBox("phone", c.phone, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("City") @Html.TextBox("city", c.city, new { @class = "form-control" })</div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-primary">Save</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>

                    <!-- Delete Customer Modal -->
                    <div class="modal fade" id="deleteCustomerModal-@c.customer_id" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                @using (Html.BeginForm("Delete", "Customers", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    @Html.Hidden("id", c.customer_id)
                                    <div class="modal-header bg-danger text-white">
                                        <h5>Confirm Delete</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">Delete <strong>@c.first_name @c.last_name</strong>?</div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-danger">Yes, Delete</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                }
            </tbody>
        </table>
    </div>

    <!-- ===== PRODUCTS SECTION ===== -->
    <div class="col-lg-4">
        <h4>Products</h4>
        <table class="table table-sm table-striped">
            <thead><tr><th>Name</th><th>Brand</th><th>Price</th><th>Actions</th></tr></thead>
            <tbody>
                @foreach (var p in Model.Products)
                {
                    <tr>
                        <td>@p.product_name</td>
                        <td>@p.brand.brand_name</td>
                        <td>@p.list_price.ToString("C")</td>
                        <td>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#editProductModal-@p.product_id">Edit</button>
                            <button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#deleteProductModal-@p.product_id">Delete</button>
                        </td>
                    </tr>

                    <!-- Edit Product Modal -->
                    <div class="modal fade" id="editProductModal-@p.product_id" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                @using (Html.BeginForm("Edit", "Products", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    @Html.Hidden("product_id", p.product_id)
                                    <div class="modal-header">
                                        <h5>Edit Product</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="mb-2">@Html.Label("Name") @Html.TextBox("product_name", p.product_name, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("Brand") @Html.DropDownList("brand_id", Model.BrandList, new { @class = "form-select" })</div>
                                        <div class="mb-2">@Html.Label("Category") @Html.DropDownList("category_id", Model.CategoryList, new { @class = "form-select" })</div>
                                        <div class="mb-2">@Html.Label("Model Year") @Html.TextBox("model_year", p.model_year, new { @class = "form-control" })</div>
                                        <div class="mb-2">@Html.Label("List Price") @Html.TextBox("list_price", p.list_price, new { @class = "form-control" })</div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-primary">Save</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>

                    <!-- Delete Product Modal -->
                    <div class="modal fade" id="deleteProductModal-@p.product_id" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                @using (Html.BeginForm("Delete", "Products", FormMethod.Post))
                                {
                                    @Html.AntiForgeryToken()
                                    @Html.Hidden("id", p.product_id)
                                    <div class="modal-header bg-danger text-white">
                                        <h5>Confirm Delete</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">Delete <strong>@p.product_name</strong>?</div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-danger">Yes, Delete</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                }
            </tbody>
        </table>
    </div>
</div>
